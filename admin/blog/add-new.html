<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | julienishimwe | portfolio</title>
    <link rel="stylesheet" href="../../pages/style.css">
    <link rel="stylesheet" href="../admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">
    <link rel="shortcut icon" type="image" href="../../img/title-logo.jpg">    
</head>

<body class="dashboard">
    <div class="sidebar">
        <h3 class="sidb-title" >Admin</h3>

        <div class="dbtn dashb">
            <a href="../index.html">
                <i class="fa-solid fa-gauge"></i>
                Dashboard
            </a>
        </div>
        <div class="dbtn posts">
            <a href="blogs.html">
                <i class="fa-solid fa-newspaper"></i>
                Articles
            </a>    
        </div>
        <div class="dbtn media">
            <a href="../messages/message.html">
                <i class="fa-solid fa-photo-film"></i>
                Messages
            </a>
        </div>
        <div class="dbtn comments">
            <a href="../comments/comment.html">
                <i class="fa-solid fa-comment"></i>
                Comments
            </a>
        </div>
        <div class="dbtn subscription">
            <a href="../users/user.html">
                <i class="fa-solid fa-message"></i>
                Subscribes
            </a>
        </div>
        <div class="dbtn settings">
            <a href="settings.html">
                <i class="fa-solid fa-gear"></i>
                Settings
            </a>
        </div>
        <div class="dbtn logout">
            <i class="fa-solid fa-arrow-right-from-bracket"></i>
            <span>Logout</span>
        </div>
    </div>
    <div class="mainbar-blog partTwo">
        <div class="dash-head">
            <div class="search-dash">
                <input type="text" placeholder="search in all">
            </div>
            <div class="admin-profile">
                <img src="../../img/profile-about-me.jpg" width="30px" height="30px" alt="">
            </div>
        </div>
        <!-- <div class="add-new-blog">
            <a href="add-new.html">Add New</a>
        </div> -->
        <div class="title-head">
            <h3>NEW BLOG</h3>
        </div>
        <div class="blog-part">
            <div class="new-blog">
                <form action="" id="newArticle">
                    <label>Title</label><br>
                    <input type="text" id="title" class="text-input"><br>
                    <label>Content</label> <br>
                    <textarea name="content" id="content"></textarea> <br>
                    <label>Image</label> <br>
                    <input type="file" id="image" name="blogImage"> <br>
                    <input type="submit" class="submit-blog" name="submit">
                </form>
            </div>
        </div>
    </div>

    <script>
       document.getElementById('newArticle').addEventListener("submit", (e) => {
        const jwt = localStorage.getItem("token");

            e.preventDefault();
                const title = document.getElementById('title').value;
                const content = document.getElementById('content').value;
                const blogImage = document.getElementById('image').value;
                const input = document.querySelector('input[type="file"]');

                var myHeaders = new Headers();
                myHeaders.append("jwt", jwt);
              
                var formdata = new FormData();
                formdata.append("title", title);
                formdata.append("content", content);
                formdata.append("blogImage", input.files[0]);

                var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: formdata,
                redirect: 'follow'
                };

                fetch("https://my-brand-project.herokuapp.com/api/v1/articles", requestOptions)
                .then(response => response.text())
                .then(result => console.log(result), alert('New article created!'))
                .catch(error => console.log('error', error));


        });
    </script>
</body>
</html>